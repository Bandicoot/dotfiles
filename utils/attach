#!/bin/bash

colors=(
    27
    34
    39
    124
    136
    141
    208
)
#colors=({1..127})

num_colors=${#colors[@]}

chr() {
  printf \\$(printf '%03o' $1)
}

# Set color to determined random color
color_num=$(bash -c 'RANDOM=$(hostname --long); echo $RANDOM')
color_num=$(expr ${color_num} % ${num_colors})
color_num=${colors[$color_num]}

PROJ_NAME=${1-"untitled_project"}

unset TMUX

if tmux has-session -t "$PROJ_NAME"; then
    echo "Attaching to session $PROJ_NAME"
else
    echo "Creating session $PROJ_NAME"
    tmux new-session -d -s "$PROJ_NAME"
fi

# Set color to determined random color
tmux set-option -g status-fg "colour253" > /dev/null
tmux set-option -g status-bg "colour${color_num}" > /dev/null
tmux set-option -g status-attr "dim" > /dev/null
tmux set-option -g window-status-attr "dim" > /dev/null
tmux set-option -g window-status-current-attr "bold" > /dev/null
tmux set-option -g window-status-current-fg "colour255" > /dev/null
tmux set-option -g window-status-current-bg "colour235" > /dev/null

ATTACH_COMMAND="tmux attach-session ${*:2} -t $PROJ_NAME"
$ATTACH_COMMAND
